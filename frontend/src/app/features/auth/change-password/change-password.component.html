<mat-card class="change-password-card">
  <h2>Change Password</h2>
  
  <div class="alert alert-danger" *ngIf="error" role="alert">
    <mat-icon>error_outline</mat-icon>
    {{ error }}
  </div>

  <div class="alert alert-success" *ngIf="success" role="alert">
    <mat-icon>check_circle_outline</mat-icon>
    {{ success }}
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Current Password</mat-label>
      <input matInput [type]="hideCurrent ? 'password' : 'text'" formControlName="currentPassword" autocomplete="current-password">
      <button mat-icon-button matSuffix type="button" (click)="hideCurrent = !hideCurrent" [attr.aria-label]="hideCurrent ? 'Show current password' : 'Hide current password'">
        <mat-icon>{{ hideCurrent ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="submitted && f['currentPassword'].hasError('required')">Current password is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>New Password</mat-label>
      <input matInput [type]="hideNew ? 'password' : 'text'" formControlName="newPassword" autocomplete="new-password">
      <button mat-icon-button matSuffix type="button" (click)="hideNew = !hideNew" [attr.aria-label]="hideNew ? 'Show new password' : 'Hide new password'">
        <mat-icon>{{ hideNew ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="submitted && f['newPassword'].hasError('required')">New password is required</mat-error>
      <mat-error *ngIf="submitted && f['newPassword'].hasError('minlength')">Minimum 8 characters required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Confirm New Password</mat-label>
      <input matInput [type]="hideConfirm ? 'password' : 'text'" formControlName="confirmPassword" autocomplete="new-password">
      <button mat-icon-button matSuffix type="button" (click)="hideConfirm = !hideConfirm" [attr.aria-label]="hideConfirm ? 'Show confirm password' : 'Hide confirm password'">
        <mat-icon>{{ hideConfirm ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="submitted && f['confirmPassword'].hasError('required')">Confirmation is required</mat-error>
      <mat-error *ngIf="submitted && f['confirmPassword'].hasError('mismatch')">Passwords do not match</mat-error>
    </mat-form-field>

    <button mat-raised-button color="primary" class="full-width" [disabled]="loading">
      {{ loading ? 'Updating...' : 'Update Password' }}
    </button>
  </form>
</mat-card>
